/* Base */
body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#0b0f14;color:#e8eef5}
header{padding:14px 16px;border-bottom:1px solid #1f2a36;background:#0f1520;position:sticky;top:0;z-index:20}
h1{margin:0 0 8px 0;font-size:20px}
nav button{margin-right:8px;padding:8px 12px;border:1px solid #2b3b4a;background:#14202d;color:#e8eef5;border-radius:12px;cursor:pointer}
nav button.active{background:#234567}
main{padding:16px;max-width:min(var(--panel-width),95vw);margin:0 auto}
.row{margin:12px 0}
.hidden{display:none}
#toast{margin-top:8px;font-size:13px;min-height:34px;opacity:0;transition:.2s ease}
#toast.show{opacity:1}
.hint{opacity:.85;margin:8px 0 10px;font-size:16px;font-weight:500;text-align:center}

/* Variables */
:root{
  --panel-width: 1700px;
  --icon: 44px;
  --pick-icon: 60px;
  --border: #2b3b4a;
  --bg2: #0f1520;
  --bg3: #101826;
  --txt: #e8eef5;
  --accent: #2a71ff;
}

/* Champs */
.field label{display:block;font-size:12px;opacity:.85;margin:0 0 6px 2px}
.field input{
  width:100%;padding:10px 12px;border-radius:10px;border:1px solid var(--border);
  background:var(--bg2);color:var(--txt);outline:none;
}
.field input:focus{border-color:#3e5a78;box-shadow:0 0 0 2px rgba(46,110,255,.15)}
.field.narrow{max-width:120px;margin-left:0;margin-right:auto}
@media (max-width:640px){.field.narrow{max-width:100%}}
#search{max-width:200px;width:100%;display:block}

/* Panel (pas de scroll ici) */
.panel{
  border:1px solid #233243;border-radius:12px;background:var(--bg2);padding:10px;
}

/* Grille fenêtre (scroll ici) */
.grid-wrap{
  border-radius:14px;background:#0f1824;
  box-shadow:0 0 0 1px rgba(255,255,255,.06),0 8px 24px rgba(0,0,0,.35);
  padding:8px;overflow:hidden; /* clippe les coins */
}
.grid-scroll{
  max-height:68vh;overflow:auto;padding:8px 12px 8px 8px;scrollbar-gutter:stable;
}

/* Grille */
.monster-grid{
  width:100%;display:grid;grid-template-columns:repeat(auto-fill,minmax(56px,1fr));
  gap:6px 8px;align-content:start;box-sizing:border-box;
}
.card{position:relative;display:flex;flex-direction:column;align-items:center;gap:4px;
  padding:4px 3px;border:1px solid transparent;border-radius:9px;background:var(--bg3);cursor:pointer}
.card:hover{border-color:#33506e}
.card img{width:44px;height:44px;border-radius:7px;object-fit:cover;background:#0b0f14}
.name{width:44px;max-width:44px;font-size:10.5px;line-height:1.05;text-align:center;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}

/* Sélection */
.picks-title{margin-bottom:6px;opacity:.9}
#picks{display:flex;flex-wrap:wrap;gap:10px;min-height:58px;margin-top:6px;width:100%}
.pick{position:relative;display:flex;flex-direction:column;align-items:center;width:86px;padding:8px 6px 6px;
  border:1px solid #2d3c4b;border-radius:10px;background:var(--bg3)}
.pick img{width:var(--pick-icon);height:var(--pick-icon);border-radius:7px;object-fit:cover}
.pick .pname{font-size:10px;line-height:11px;margin-top:4px;text-align:center;max-width:76px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.pick .close{position:absolute;top:4px;right:4px;width:18px;height:18px;border:none;border-radius:50%;
  background:#0f1520;color:#cfd8e3;opacity:.6;cursor:pointer;line-height:18px;font-size:12px;z-index:10}
.pick .close:hover{opacity:.9}

/* Zone notes + bouton */
textarea{width:100%;min-height:100px;border-radius:12px;border:1px solid var(--border);background:var(--bg2);color:var(--txt);padding:10px;outline:none}
textarea:focus{border-color:#3e5a78;box-shadow:0 0 0 2px rgba(46,110,255,.15)}
.btn-primary{appearance:none;border:none;background:linear-gradient(180deg,#2a71ff,#1b55d6);color:#fff;padding:10px 16px;border-radius:12px;cursor:pointer;font-weight:600;box-shadow:0 4px 12px rgba(42,113,255,.25);transition:.05s ease}
.btn-primary:hover{filter:brightness(1.05)} .btn-primary:active{transform:translateY(1px)} .btn-primary[disabled]{opacity:.6;cursor:default}
.btn-spinner{width:16px;height:16px;border-radius:50%;border:2px solid rgba(255,255,255,.4);border-top-color:#fff;display:none}
.btn-primary.sending .btn-spinner{display:inline-block;animation:spin .8s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* Listes */
.def-row{display:flex;align-items:center;gap:10px;width:100%;max-width:920px;margin:0 auto}
.def-item{flex:1;display:flex;align-items:center;justify-content:space-between;gap:20px;border:1px solid #223244;background:#0f1520;border-radius:12px;padding:14px 16px;box-shadow:0 6px 18px rgba(0,0,0,.22)}
.def-trio{display:flex;gap:16px;align-items:center}
.def-pick{width:110px;padding:8px 6px 6px}
.def-pick img{width:60px;height:60px;border-radius:10px}
.def-pick .pname{font-size:12px;line-height:13px;margin-top:6px;max-width:100px}
.def-count{min-width:48px;text-align:center;font-weight:800;font-size:16px;color:#fff;background:#234567;border:1px solid #2f5577;border-radius:10px;padding:10px 14px;box-shadow:inset 0 0 0 1px rgba(255,255,255,.06)}
.btn-ghost{appearance:none;border:1px solid #2b3b4a;background:#101826;color:#e8eef5;padding:6px 10px;border-radius:10px;cursor:pointer;font-size:12px;white-space:nowrap}
.btn-ghost:hover{border-color:#3a4c60}
.def-list{display:flex;flex-direction:column;gap:12px;width:100%;margin:12px auto 0;max-width:940px}

/* Scrollbar page (discrète) */
body::-webkit-scrollbar{width:8px}
body::-webkit-scrollbar-track{background:transparent}
body::-webkit-scrollbar-thumb{background:rgba(255,255,255,.12);border-radius:6px}
body::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.20)}
body{scrollbar-width:thin;scrollbar-color:rgba(255,255,255,.12) transparent}

/* Responsive pour 1080p */
@media (max-height:900px){
  .grid-scroll{max-height:58vh}
  :root{--icon:40px}
  .monster-grid{grid-template-columns:repeat(auto-fill,minmax(52px,1fr));gap:6px 7px}
  .card img{width:var(--icon);height:var(--icon)}
  .name{font-size:10px}
}
@media (max-width:1280px){
  main{max-width:94vw}
  .grid-scroll{max-height:60vh}
  .monster-grid{grid-template-columns:repeat(auto-fill,minmax(50px,1fr))}
}

/* modal générique */
.modal.hidden { display:none; }
.modal { position:fixed; inset:0; z-index:9999; }
.modal-backdrop { position:absolute; inset:0; background:rgba(0,0,0,.45); }
.modal-card { position:relative; margin:5vh auto; width:min(900px, calc(100% - 24px));
  background:#0f172a; color:#e2e8f0; border:1px solid #22314a; border-radius:12px; padding:12px; }
.modal-header { display:flex; align-items:center; gap:12px; }
.modal-back { border:none; background:transparent; color:#cbd5e1; font-size:20px; cursor:pointer; }

.off-row { display:flex; gap:12px; align-items:center; justify-content:space-between;
  padding:10px; border:1px solid #1f2b3a; border-radius:10px; background:#111927; }
.off-trio { display:flex; gap:10px; align-items:center; }
.off-pick { display:flex; flex-direction:column; align-items:center; font-size:12px; width:90px; }
.off-pick img { width:64px; height:64px; object-fit:cover; border-radius:8px; border:1px solid #2b3b55; }
.off-note { color:#94a3b8; font-size:12px; }

.offs-grid { display:grid; grid-template-columns: repeat(auto-fill, minmax(290px, 1fr)); gap:12px; }

/* Carte “+ ajouter” centrée */
.add-card { display:flex; align-items:center; justify-content:center; gap:10px;
  border:2px dashed #334155; border-radius:12px; background:#0b1220; padding:18px; cursor:pointer; }
.add-card:hover { background:#0e1526; border-color:#3b82f6; }
.add-plus { width:38px; height:38px; border-radius:999px; background:#1e3a8a; color:#fff;
  display:flex; align-items:center; justify-content:center; font-size:22px; }
.add-label { color:#93c5fd; font-weight:600; }

/* Chooser */
#offs-chooser { margin-top:12px; }
.chooser-bar { display:flex; gap:10px; align-items:center; margin-bottom:10px; }
#offs-search { flex:1; padding:8px; border-radius:8px; border:1px solid #334155; background:#0b1220; color:#e2e8f0; }
.chosen { display:flex; gap:6px; }
.chip { padding:6px 10px; border-radius:999px; background:#1e293b; color:#e2e8f0; font-size:12px; }
.chip.empty { opacity:.6; }
.btn.primary[disabled] { opacity:.5; cursor:not-allowed; }

/* ⬇️ Grille de la modale seulement (scopée) */
#offs-grid.monster-grid {
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(120px,1fr));
  gap:10px;
}
#offs-modal .mon-card { border:1px solid #263349; border-radius:10px; padding:8px; background:#0b1220; cursor:pointer; text-align:center; }
#offs-modal .mon-card img { width:72px; height:72px; border-radius:8px; border:1px solid #22314a; }
#offs-modal .mon-card.selected { outline:2px solid #3b82f6; }
.note-row { margin-top:8px; }
.note-row input { width:100%; padding:8px; border-radius:8px; border:1px solid #334155; background:#0b1220; color:#e2e8f0; }
